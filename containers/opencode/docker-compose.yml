services:
  code:
    image: ${IMAGE}
    tty: true
    stdin_open: true
    working_dir: /workspaces
    # Keep container running for exec access
    command: tail -f /dev/null
    volumes:
      # Mount the repository (parent of docker/ directory)
      - ${REPO}:/workspaces/repo:rw
      - ${WORKTREES}:/workspaces/worktrees:rw
      - ${DOCS}:/workspaces/docs:rw

      # Share git and ssh config from host for repo access
      - ${HOME}/.gitconfig:/home/node/.gitconfig:ro
      - ${HOME}/.ssh:/home/node/.ssh:ro

      # Editor Configuration
      - ${HOME}/.config/opencode:/home/node/.config/opencode
      - ${HOME}/.local/share/opencode:/home/node/.local/share/opencode

      # Sepcific File Overrides
      - ${AGENTS_MD:-../../files/AGENTS.md}:/workspaces/AGENTS.md:ro
      
